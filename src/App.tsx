import { useState } from 'react';
import './App.css';

type Indicator = 'H' | 'E' | 'A' | 'R' | 'T';
// í™”ë©´ ìƒíƒœë¥¼ ì •ì˜í•©ë‹ˆë‹¤: 'HOME' (ì‹œì‘), 'QUIZ' (ì§„í–‰), 'RESULT' (ê²°ê³¼)
type ViewState = 'HOME' | 'QUIZ' | 'RESULT';

interface Option {
  text: string;
  type: Indicator;
}

interface Question {
  q: string;
  options: [Option, Option];
}

function App() {
  const [view, setView] = useState<ViewState>('HOME'); // í˜„ì¬ í™”ë©´ ìƒíƒœ
  const [step, setStep] = useState<number>(0);
  const [scores, setScores] = useState<Record<Indicator, number>>({
    H: 0, E: 0, A: 0, R: 0, T: 0
  });

  const questions: Question[] = [
    { // 1ë²ˆ ë¬¸ì œ
      q: "ë‹¤ìŒ ì¤‘ ë¶€ì¥ë‹˜ì˜ í‰ì†Œ ëª¨ìŠµê³¼ ë” ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.",
      options: [
        { text: "[ì •ë„] ë‚˜ëŠ” ë‹¨ê¸°ì„±ê³¼ë¥¼ ìœ„í•´ ê¼¼ìˆ˜ë¥¼ ë¶€ë¦¬ì§€ ì•Šê³  'ì •ë„' ì˜ì—…(ì—…ë¬´)ë¥¼ ì§€ì‹œí•œë‹¤.", type: "H" },
        { text: "[ë¬¸ì œí•´ê²°] ë‚˜ëŠ” ì–´ë ¤ìš´ ë¬¸ì œê°€ ìƒê²¼ì„ ë•Œ ìµœì„ ì˜ í•´ê²°ì±…ì„ ì œì‹œí•œë‹¤.", type: "E" }
      ]
    },
    { // 2ë²ˆ ë¬¸ì œ
      q: "ë‹¤ìŒ ì¤‘ ë¶€ì¥ë‹˜ì˜ í‰ì†Œ ëª¨ìŠµê³¼ ë” ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.",
      options: [
        { text: "[ë°©í–¥ì œì‹œ] ë‚˜ëŠ” ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ ì ê·¹ì ì´ê³  êµ¬ì²´ì ì¸ ì‚¬ë¡€ì™€ ë°©í–¥ì„±ì„ ì œì‹œí•œë‹¤.", type: "A" },
        { text: "[ì¡´ì¤‘] ë‚˜ëŠ” ë‚˜ì˜ ì˜ê²¬ê³¼ êµ¬ì„±ì›ì˜ ì˜ê²¬ì´ ë‹¤ë¥¼ ë•Œì—ë„ ë¬´ì‹œí•˜ì§€ ì•Šê³  ê²½ì²­í•œë‹¤.", type: "T" }
      ]
    },
    { // 3ë²ˆ ë¬¸ì œ
      q: "ë‹¤ìŒ ì¤‘ ë¶€ì¥ë‹˜ì˜ í‰ì†Œ ëª¨ìŠµê³¼ ë” ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.",
      options: [
        { text: "[ëŒ€ë‚´í˜‘ë ¥] ë‚˜ëŠ” ì‹¤ë¬´ì ê°„ì˜ ê°ˆë“± ë°œìƒ ì‹œ ì ê·¹ì ìœ¼ë¡œ ì¤‘ì¬í•œë‹¤.", type: "T" },
        { text: "[ê³µì •] ë‚˜ëŠ” ì§ê´€ì´ë‚˜ ê¸°ë¶„ì´ ì•„ë‹Œ ê°ê´€ì ì¸ ê¸°ì¤€ì— ë”°ë¼ ì˜ì‚¬ê²°ì •í•œë‹¤.", type: "H" }
      ]
    },
    { // 4ë²ˆ ë¬¸ì œ
      q: "ë‹¤ìŒ ì¤‘ ë¶€ì¥ë‹˜ì˜ í‰ì†Œ ëª¨ìŠµê³¼ ë” ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.",
      options: [
        { text: "[ê²½í—˜,ì§€ì‹] ë‚˜ëŠ” ì—…ë¬´ê´€ë ¨ ë›°ì–´ë‚œ ì§€ì‹ê³¼ ê²½í—˜ì„ ê°–ê³  ìˆë‹¤.", type: "E" },
        { text: "[ì¼ì •ê´€ë¦¬] ë‚˜ëŠ” ì² ì €í•œ ì¼ì • ê´€ë¦¬ë¥¼ í†µí•´ ê²°ê³¼ë¬¼ì„ ì™„ì„±í•œë‹¤.", type: "A" }
      ]
    },
    { // 5ë²ˆ ë¬¸ì œ
      q: "ë‹¤ìŒ ì¤‘ ë¶€ì¥ë‹˜ì˜ í‰ì†Œ ëª¨ìŠµê³¼ ë” ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.",
      options: [
        { text: "[ì¸ì¬ìœ¡ì„±] ë‚˜ëŠ” êµ¬ì„±ì›ë“¤ì˜ ì—­ëŸ‰ í–¥ìƒì„ ìœ„í•´ ì •ê¸°ì ìœ¼ë¡œ ë©´ë‹´ì„ ì§„í–‰í•œë‹¤.", type: "R" },
        { text: "[ëŒ€ì™¸í˜‘ë ¥] ë‚˜ëŠ” íƒ€ë¶€ì„œì™€ ì‹ ë¢°ê´€ê³„ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì›í™œí•œ í˜‘ì—…ì„ ì´ëŒì–´ë‚¸ë‹¤.", type: "T" }
      ]
    },
    { // 6ë²ˆ ë¬¸ì œ
      q: "ë‹¤ìŒ ì¤‘ ë¶€ì¥ë‹˜ì˜ í‰ì†Œ ëª¨ìŠµê³¼ ë” ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.",
      options: [
        { text: "[ì¼ì •ê´€ë¦¬] ë‚˜ëŠ” ì² ì €í•œ ì¼ì • ê´€ë¦¬ë¥¼ í†µí•´ ê²°ê³¼ë¬¼ì„ ì™„ì„±í•œë‹¤.", type: "A" },
        { text: "[ì •ë„] ë‚˜ëŠ” ë‹¨ê¸°ì„±ê³¼ë¥¼ ìœ„í•´ ê¼¼ìˆ˜ë¥¼ ë¶€ë¦¬ì§€ ì•Šê³  'ì •ë„' ì˜ì—…(ì—…ë¬´)ë¥¼ ì§€ì‹œí•œë‹¤.", type: "H" }
      ]
    },
    { // 7ë²ˆ ë¬¸ì œ
      q: "ë‹¤ìŒ ì¤‘ ë¶€ì¥ë‹˜ì˜ í‰ì†Œ ëª¨ìŠµê³¼ ë” ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.",
      options: [
        { text: "[ì¡´ì¤‘] ë‚˜ëŠ” ë‚˜ì˜ ì˜ê²¬ê³¼ êµ¬ì„±ì›ì˜ ì˜ê²¬ì´ ë‹¤ë¥¼ ë•Œì—ë„ ë¬´ì‹œí•˜ì§€ ì•Šê³  ê²½ì²­í•œë‹¤.", type: "R" },
        { text: "[ê²½í—˜,ì§€ì‹] ë‚˜ëŠ” ì—…ë¬´ê´€ë ¨ ë›°ì–´ë‚œ ì§€ì‹ê³¼ ê²½í—˜ì„ ê°–ê³  ìˆë‹¤.", type: "E" }
      ]
    },
    { // 8ë²ˆ ë¬¸ì œ
      q: "ë‹¤ìŒ ì¤‘ ë¶€ì¥ë‹˜ì˜ í‰ì†Œ ëª¨ìŠµê³¼ ë” ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.",
      options: [
        { text: "[ë¬¸ì œí•´ê²°] ë‚˜ëŠ” ì–´ë ¤ìš´ ë¬¸ì œê°€ ìƒê²¼ì„ ë•Œ ìµœì„ ì˜ í•´ê²°ì±…ì„ ì œì‹œí•œë‹¤.", type: "E" },
        { text: "[ëŒ€ë‚´í˜‘ë ¥] ì‹¤ë¬´ì ê°„ì˜ ê°ˆë“± ë°œìƒ ì‹œ ì ê·¹ì ìœ¼ë¡œ ì¤‘ì¬í•œë‹¤.", type: "T" }
      ]
    },
    { // 3ë²ˆ ë¬¸ì œ
      q: "ë‹¤ìŒ ì¤‘ ë¶€ì¥ë‹˜ì˜ í‰ì†Œ ëª¨ìŠµê³¼ ë” ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.",
      options: [
        { text: "[ê³µì •] ë‚˜ëŠ” ì§ê´€ì´ë‚˜ ê¸°ë¶„ì´ ì•„ë‹Œ ê°ê´€ì ì¸ ê¸°ì¤€ì— ë”°ë¼ ì˜ì‚¬ê²°ì •í•œë‹¤.", type: "H" },
        { text: "[ì¸ì¬ìœ¡ì„±] ë‚˜ëŠ” êµ¬ì„±ì›ë“¤ì˜ ì—­ëŸ‰ í–¥ìƒì„ ìœ„í•´ ì •ê¸°ì ìœ¼ë¡œ ë©´ë‹´ì„ ì§„í–‰í•œë‹¤.", type: "R" }
      ]
    },
    { // 3ë²ˆ ë¬¸ì œ
      q: "ë‹¤ìŒ ì¤‘ ë¶€ì¥ë‹˜ì˜ í‰ì†Œ ëª¨ìŠµê³¼ ë” ê°€ê¹Œìš´ ì„ íƒì§€ë¥¼ ê³¨ë¼ì£¼ì„¸ìš”.",
      options: [
        { text: "[ëŒ€ì™¸í˜‘ë ¥] ë‚˜ëŠ” íƒ€ë¶€ì„œì™€ ì‹ ë¢°ê´€ê³„ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì›í™œí•œ í˜‘ì—…ì„ ì´ëŒì–´ë‚¸ë‹¤.", type: "T" },
        { text: "[ë°©í–¥ì œì‹œ] ë‚˜ëŠ” ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ ì ê·¹ì ì´ê³  êµ¬ì²´ì ì¸ ì‚¬ë¡€ì™€ ë°©í–¥ì„±ì„ ì œì‹œí•œë‹¤.", type: "A" }
      ]
    },
  ];

  const handleStart = () => {
    setView('QUIZ');
  };
// App.tsx ë‚´ì˜ handleAnswer í•¨ìˆ˜

const handleAnswer = (type: Indicator) => {
  // 1. í˜„ì¬ í´ë¦­ëœ ë²„íŠ¼ì˜ í¬ì»¤ìŠ¤ë¥¼ ê°•ì œë¡œ í•´ì œ (ì”ìƒ ë°©ì§€)
  if (document.activeElement instanceof HTMLElement) {
    document.activeElement.blur();
  }

  // 2. ì ìˆ˜ ê³„ì‚° ë° ë‹¨ê³„ ì´ë™ ë¡œì§
  setScores(prev => ({ ...prev, [type]: prev[type] + 1 }));

  if (step < questions.length - 1) {
    setStep(step + 1);
  } else {
    setView('RESULT');
  }
};

  return (
    <div className="App">
      {/* 1. ì‹œì‘ í™”ë©´ */}
      {view === 'HOME' && (
        <div className="card start-card">
          <div className="emoji">ğŸš€</div>
          <h1>ë¦¬ë”ì‹­ ì„¤ë¬¸ì¡°ì‚¬</h1>
          <p>ë¶€ì¥ë‹˜ê»˜ì„œ ìƒê°í•˜ì‹œëŠ” ë³¸ì¸ì˜ ë¦¬ë”ì‹­ì€ ì–´ë–¤ ëª¨ìŠµì¼ê¹Œìš”?<br/>10ê°œì˜ ì§ˆë¬¸ì„ í†µí•´ ì•Œì•„ë³´ì„¸ìš”.</p>
          <button className="main-btn" onClick={handleStart}>í…ŒìŠ¤íŠ¸ ì‹œì‘í•˜ê¸°</button>
        </div>
      )}

      {/* 2. ì§ˆë¬¸ í™”ë©´ */}
      {view === 'QUIZ' && (
        <div className="card">
          <p className="progress">Q {step + 1} / {questions.length}</p>
          <h2 className="question-text">{questions[step].q}</h2>
          <div className="button-group">
            {questions[step].options.map((option, idx) => (
              <button key={idx} onClick={() => handleAnswer(option.type)}>
                {option.text}
              </button>
            ))}
          </div>
        </div>
      )}

      {/* 3. ê²°ê³¼ í™”ë©´ */}
      {view === 'RESULT' && (
        <div className="card result-card">
          <h2 className="result-type">ë¶„ì„ ì™„ë£Œ!</h2>
          <p>ì•„ë˜ ê²°ê³¼ë¥¼ ë¶€ì„œì›ì´ í•œ ë¦¬ë”ì‹­ ì„¤ë¬¸ ê²°ê³¼ì— ë§ê·¸ë ¤ ì£¼ì„¸ìš”.</p>
          <div className="score-details">
            <h2>H:  {scores.H} <br/>
            E: {scores.E} <br/>A: {scores.A} <br/>R: {scores.R} <br/>T: {scores.T}<br/></h2>
          </div>
          <button className="retry-btn" onClick={() => window.location.reload()}>ë‹¤ì‹œ í•˜ê¸°</button>
        </div>
      )}
    </div>
  );
}

export default App;